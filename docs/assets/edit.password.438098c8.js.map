{"version":3,"file":"edit.password.438098c8.js","sources":["../../src/components/FixedActionBar/index.vue","../../src/views/personal/edit.password.vue"],"sourcesContent":["<script setup name=\"FixedActionBar\">\nconst data = ref({\n    isBottom: true\n})\n\nonMounted(() => {\n    onScroll()\n    window.addEventListener('scroll', onScroll)\n})\n\nonUnmounted(() => {\n    window.removeEventListener('scroll', onScroll)\n})\n\nfunction onScroll() {\n    // 变量scrollTop是滚动条滚动时，滚动条上端距离顶部的距离\n    var scrollTop = document.documentElement.scrollTop || document.body.scrollTop\n    // 变量windowHeight是可视区的高度\n    var windowHeight = document.documentElement.clientHeight || document.body.clientHeight\n    // 变量scrollHeight是滚动条的总高度（当前可滚动的页面的总高度）\n    var scrollHeight = document.documentElement.scrollHeight || document.body.scrollHeight\n    // 滚动条到底部\n    if (Math.ceil(scrollTop + windowHeight) >= scrollHeight) {\n        data.value.isBottom = true\n    } else {\n        data.value.isBottom = false\n    }\n}\n</script>\n\n<template>\n    <div class=\"actionbar\" :class=\"{'shadow': !data.isBottom}\" data-fixed-calc-width>\n        <slot />\n    </div>\n</template>\n\n<style lang=\"scss\" scoped>\n.actionbar {\n    z-index: 4;\n    bottom: 0;\n    padding: 20px;\n    text-align: center;\n    background-color: var(--g-app-bg);\n    box-shadow: 0 0 1px 0 var(--g-box-shadow-color);\n    transition: all 0.3s, var(--el-transition-box-shadow);\n    &.shadow {\n        box-shadow: 0 -10px 10px -10px var(--g-box-shadow-color);\n    }\n}\n:deep(.el-form-item) {\n    margin-bottom: 0;\n}\n</style>\n","<route>\n{\n    meta: {\n        title: \"修改密码\",\n        parentTitle: \"个人信息\",\n        parentIcon: \"config\"\n    }\n}\n</route>\n\n<script setup name=\"PersonalEditPassword\">\nconst route = useRoute(), router = useRouter()\nconst { proxy } = getCurrentInstance()\n\nimport useUserStore from '@/store/modules/user'\nconst userStore = useUserStore()\n\nconst validatePassword = (rule, value, callback) => {\n    if (value !== form.value.newpassword) {\n        callback(new Error('请确认新密码'))\n    } else {\n        callback()\n    }\n}\n\nconst form = ref({\n    password: '',\n    newpassword: '',\n    checkpassword: ''\n})\n\nconst rules = ref({\n    password: [\n        { required: true, message: '请输入原密码', trigger: 'blur' }\n    ],\n    newpassword: [\n        { required: true, message: '请输入新密码', trigger: 'blur' },\n        { min: 6, max: 18, trigger: 'blur', message: '密码长度为6到18位' }\n    ],\n    checkpassword: [\n        { required: true, message: '请输入新密码', trigger: 'blur' },\n        { validator: validatePassword }\n    ]\n})\n\nfunction onSubmit() {\n    proxy.$refs['formRef'].validate(valid => {\n        if (valid) {\n            userStore.editPassword(form.value).then(() => {\n                ElMessage({\n                    type: 'success',\n                    message: '模拟修改成功，请重新登录'\n                })\n                userStore.logout().then(() => {\n                    router.push({\n                        name: 'login',\n                        query: {\n                            redirect: route.fullPath\n                        }\n                    })\n                })\n            }).catch(() => {})\n        }\n    })\n}\n</script>\n\n<template>\n    <div>\n        <page-header title=\"修改密码\" content=\"定期修改密码可以提高帐号安全性噢~\" />\n        <page-main>\n            <el-row>\n                <el-col :md=\"24\" :lg=\"12\">\n                    <el-form ref=\"formRef\" :model=\"form\" :rules=\"rules\" label-width=\"120px\">\n                        <el-form-item label=\"原密码\" prop=\"password\">\n                            <el-input v-model=\"form.password\" type=\"password\" placeholder=\"请输入原密码\" />\n                        </el-form-item>\n                        <el-form-item label=\"新密码\" prop=\"newpassword\">\n                            <el-input v-model=\"form.newpassword\" type=\"password\" placeholder=\"请输入原密码\" />\n                        </el-form-item>\n                        <el-form-item label=\"确认新密码\" prop=\"checkpassword\">\n                            <el-input v-model=\"form.checkpassword\" type=\"password\" placeholder=\"请输入原密码\" />\n                        </el-form-item>\n                    </el-form>\n                </el-col>\n            </el-row>\n        </page-main>\n        <fixed-action-bar>\n            <el-button type=\"primary\" size=\"large\" @click=\"onSubmit\">提交</el-button>\n        </fixed-action-bar>\n    </div>\n</template>\n"],"names":["data","ref","isBottom","onScroll","scrollTop","document","documentElement","body","windowHeight","clientHeight","scrollHeight","Math","ceil","value","onMounted","window","addEventListener","onUnmounted","removeEventListener","route","useRoute","router","useRouter","proxy","getCurrentInstance","userStore","useUserStore","form","password","newpassword","checkpassword","rules","required","message","trigger","min","max","validator","rule","callback","Error","onSubmit","$refs","validate","valid","editPassword","then","ElMessage","type","logout","push","name","query","redirect","fullPath","catch"],"mappings":"opBACA,MAAAA,EAAAC,EAAA,CACAC,UAAA,IAYA,SAAAC,IAEA,IAAAC,EAAAC,SAAAC,gBAAAF,WAAAC,SAAAE,KAAAH,UAEAI,EAAAH,SAAAC,gBAAAG,cAAAJ,SAAAE,KAAAE,aAEAC,EAAAL,SAAAC,gBAAAI,cAAAL,SAAAE,KAAAG,aAEAC,KAAAC,KAAAR,EAAAI,IAAAE,EACAV,EAAAa,MAAAX,UAAA,EAEAF,EAAAa,MAAAX,UAAA,SApBAY,GAAA,KACAX,IACAY,OAAAC,iBAAA,SAAAb,MAGAc,GAAA,KACAF,OAAAG,oBAAA,SAAAf,uQCAA,MAAAgB,EAAAC,IAAAC,EAAAC,KACAC,MAAAA,GAAAC,IAGAC,EAAAC,IAUAC,EAAA1B,EAAA,CACA2B,SAAA,GACAC,YAAA,GACAC,cAAA,KAGAC,EAAA9B,EAAA,CACA2B,SAAA,CACA,CAAAI,UAAA,EAAAC,QAAA,SAAAC,QAAA,SAEAL,YAAA,CACA,CAAAG,UAAA,EAAAC,QAAA,SAAAC,QAAA,QACA,CAAAC,IAAA,EAAAC,IAAA,GAAAF,QAAA,OAAAD,QAAA,eAEAH,cAAA,CACA,CAAAE,UAAA,EAAAC,QAAA,SAAAC,QAAA,QACA,CAAAG,UAxBA,CAAAC,EAAAzB,EAAA0B,KACA1B,IAAAc,EAAAd,MAAAgB,YACAU,EAAA,IAAAC,MAAA,WAEAD,SAwBA,SAAAE,IACAlB,EAAAmB,MAAA,QAAAC,UAAAC,IACAA,GACAnB,EAAAoB,aAAAlB,EAAAd,OAAAiC,MAAA,KACAC,EAAA,CACAC,KAAA,UACAf,QAAA,iBAEAR,EAAAwB,SAAAH,MAAA,KACAzB,EAAA6B,KAAA,CACAC,KAAA,QACAC,MAAA,CACAC,SAAAlC,EAAAmC,kBAIAC,OAAA"}
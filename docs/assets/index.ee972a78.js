
/**
 * 由 Fantastic-admin 提供技术支持
 * Powered by Fantastic-admin
 * https://fantastic-admin.netlify.app
 * 代码仓库
 * Gitee  https://gitee.com/hooray/fantastic-admin
 * Github https://github.com/hooray/fantastic-admin
 */
    
import{_ as e,d as a,u as t,$ as s,b as l,A as n,c as r,w as o,o as u,a0 as i,H as c,e as d,f as m,D as p,g as h,l as v,a1 as f,h as b,k as $,n as g,L as y,P as k,M as _,N as j,Y as x,m as B,x as w,s as S,t as T,j as P,J as C}from"./index.015bb7ab.js";import{E as O}from"./el-input.8c6a35eb.js";/* empty css                */import{_ as I}from"./index.2f891fd2.js";import"./typescript2.b7eef2c1.js";import"./index2.3d38e54c.js";import"./index2.7bb86833.js";import"./error2.13f96d52.js";const L=e=>(_("data-v-6d285be8"),e=e(),j(),e),D={class:"container"},H={key:0,class:"tips"},M=L((()=>m("div",{class:"tip"},[m("span",null,"Alt"),x("+"),m("span",null,"S"),x(" 唤醒搜索面板 ")],-1))),N={class:"tip"},V=x(" 切换搜索结果 "),q={class:"tip"},A=x(" 访问页面 "),E=L((()=>m("div",{class:"tip"},[m("span",null,"ESC"),x(" 退出 ")],-1))),K=["href","target","onClick","onMouseover"],U={class:"info"},J={class:"title"},R={class:"breadcrumb"},Y={class:"path"},z=a({name:"Search"});var F=e(Object.assign(z,{setup(e){const{proxy:a}=B(),_=t(),j=s(),L=l(),z=n(!1),F=n(""),G=n([]),Q=n(-1),W=r((()=>{let e=[];return e=G.value.filter((e=>{let a=!1;return e.title.indexOf(F.value)>=0&&(a=!0),e.path.indexOf(F.value)>=0&&(a=!0),e.breadcrumb.some((e=>e.indexOf(F.value)>=0))&&(a=!0),a})),e}));function X(e){e.map((e=>{if(!1!==e.meta.sidebar)if(function(e){let a=!0;return e.children?e.children.every((e=>!1===e.meta.sidebar))&&(a=!1):a=!1,a}(e)){let a=e.meta.baseBreadcrumb?i(e.meta.baseBreadcrumb):[];a.push(e.meta.title);let t=i(e.children);t.map((t=>{t.meta.baseIcon=e.meta.icon||e.meta.baseIcon,t.meta.baseBreadcrumb=a,t.meta.basePath=e.meta.basePath?[e.meta.basePath,e.path].join("/"):e.path})),X(t)}else{let a=[];e.meta.baseBreadcrumb&&(a=i(e.meta.baseBreadcrumb)),a.push(e.meta.title);let t="";t=w(e.path)?e.path:e.meta.basePath?[e.meta.basePath,e.path].join("/"):e.path,G.value.push({icon:e.meta.icon||e.meta.baseIcon,title:e.meta.title,i18n:e.meta.i18n,breadcrumb:a,path:t})}}))}function Z(){W.value.length&&(Q.value-=1,Q.value<0&&(Q.value=W.value.length-1),te())}function ee(){W.value.length&&(Q.value+=1,Q.value>W.value.length-1&&(Q.value=0),te())}function ae(){-1!==Q.value&&a.$refs[`search-item-${Q.value}`][0].click()}function te(){let e=0;if(-1!==Q.value){e=a.$refs.search.scrollTop;const t=a.$refs[`search-item-${Q.value}`][0].offsetTop,s=a.$refs[`search-item-${Q.value}`][0].clientHeight,l=a.$refs.search.scrollTop,n=a.$refs.search.clientHeight;t+s>l+n?e=t+s-n:t<=l&&(e=t)}a.$refs.search.scrollTo({top:e})}return o((()=>z.value),(e=>{e?(document.querySelector("body").classList.add("hidden"),a.$refs.search.scrollTop=0,a.$hotkeys("up",Z),a.$hotkeys("down",ee),a.$hotkeys("enter",ae),setTimeout((()=>{a.$refs.input.focus()}),500)):(document.querySelector("body").classList.remove("hidden"),a.$hotkeys.unbind("up",Z),a.$hotkeys.unbind("down",ee),a.$hotkeys.unbind("enter",ae),setTimeout((()=>{F.value="",Q.value=-1}),500))})),o((()=>W.value),(()=>{Q.value=-1,te()})),u((()=>{a.$eventBus.on("global-search-toggle",(()=>{z.value=!z.value})),a.$hotkeys("alt+s",(e=>{_.topbar.enableNavSearch&&(e.preventDefault(),z.value=!0)})),a.$hotkeys("esc",(e=>{_.topbar.enableNavSearch&&(e.preventDefault(),z.value=!1)})),"filesystem"!==_.app.routeBaseOn?j.routes.map((e=>{X(e.children)})):L.menus.map((e=>{X(e.children)}))})),(e,a)=>{const t=I,s=c,l=O,n=S("router-link");return T(),d("div",{id:"search",class:g({searching:z.value}),onClick:a[3]||(a[3]=a=>z.value&&e.$eventBus.emit("global-search-toggle"))},[m("div",D,[m("div",{class:"search-box",onClick:a[2]||(a[2]=p((()=>{}),["stop"]))},[h(l,{ref:"input",modelValue:F.value,"onUpdate:modelValue":a[0]||(a[0]=e=>F.value=e),placeholder:"搜索页面，支持标题、URL模糊查询",clearable:"",onKeydown:[a[1]||(a[1]=f((a=>e.$eventBus.emit("global-search-toggle")),["esc"])),f(p(Z,["prevent"]),["up"]),f(p(ee,["prevent"]),["down"]),f(p(ae,["prevent"]),["enter"])]},{prefix:v((()=>[h(s,null,{default:v((()=>[h(t,{name:"ep:search"})])),_:1})])),_:1},8,["modelValue","onKeydown"]),"pc"===b(_).mode?(T(),d("div",H,[M,m("div",N,[m("span",null,[h(s,null,{default:v((()=>[h(t,{name:"search-up"})])),_:1})]),m("span",null,[h(s,null,{default:v((()=>[h(t,{name:"search-down"})])),_:1})]),V]),m("div",q,[m("span",null,[h(s,null,{default:v((()=>[h(t,{name:"search-enter"})])),_:1})]),A]),E])):$("v-if",!0)]),m("div",{ref:"search",class:g(["result",{mobile:"mobile"===b(_).mode}])},[(T(!0),d(y,null,k(b(W),((e,a)=>(T(),P(n,{key:e.path,custom:"",to:z.value?e.path:""},{default:v((({href:l,navigate:n})=>[m("a",{ref_for:!0,ref:`search-item-${a}`,href:b(w)(e.path)?e.path:l,class:g(["item",{actived:a===Q.value}]),target:b(w)(e.path)?"_blank":"_self",onClick:n,onMouseover:e=>Q.value=a},[h(s,{class:"icon"},{default:v((()=>[e.icon?(T(),P(t,{key:0,name:e.icon},null,8,["name"])):$("v-if",!0)])),_:2},1024),m("div",U,[m("div",J,C(e.title),1),m("div",R,[(T(!0),d(y,null,k(e.breadcrumb,((e,a)=>(T(),d("span",{key:a},[x(C(e)+" ",1),h(s,null,{default:v((()=>[h(t,{name:"ep:arrow-right"})])),_:1})])))),128))]),m("div",Y,C(e.path),1)])],42,K)])),_:2},1032,["to"])))),128))],2)])],2)}}}),[["__scopeId","data-v-6d285be8"]]);export{F as default};
//# sourceMappingURL=index.ee972a78.js.map
